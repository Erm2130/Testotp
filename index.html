<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OTP Automation Testing Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Sarabun:wght@400;600&display=swap');
        body { font-family: 'Sarabun', 'Inter', sans-serif; }
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* สไตล์สำหรับกล่อง OTP มุมขวาบน */
        #otpDisplay {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 50;
            display: none;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <!-- OTP Display Box (Top Right) -->
    <div id="otpDisplay">
        <div class="bg-white border-l-4 border-indigo-600 shadow-xl rounded-xl p-4 flex items-center gap-4">
            <div class="bg-indigo-100 p-2 rounded-lg text-indigo-600">
                <i data-lucide="message-square-text" class="w-6 h-6"></i>
            </div>
            <div>
                <p class="text-[10px] uppercase tracking-wider font-bold text-gray-400">Your OTP Code</p>
                <p id="generatedOtpText" class="text-2xl font-mono font-bold text-indigo-700 tracking-[0.2em]">- - - - - -</p>
            </div>
            <button onclick="closeOtpDisplay()" class="text-gray-300 hover:text-gray-500 transition-colors">
                <i data-lucide="x" class="w-4 h-4"></i>
            </button>
        </div>
    </div>

    <div class="max-w-md w-full bg-white rounded-3xl shadow-2xl overflow-hidden border border-gray-200">
        <!-- Header -->
        <div class="bg-indigo-600 p-8 text-white text-center">
            <div class="inline-flex p-3 bg-white/20 rounded-full mb-4">
                <i data-lucide="shield-check" class="w-8 h-8"></i>
            </div>
            <h1 class="text-2xl font-bold">OTP Testing Lab</h1>
            <p class="text-indigo-100 text-sm mt-2">พื้นที่สำหรับฝึกเขียนสคริปต์ Automation</p>
        </div>

        <!-- Main Content -->
        <div class="p-8">
            <div id="step1" class="space-y-6">
                <div>
                    <label for="phoneInput" class="block text-sm font-semibold text-gray-700 mb-2">เบอร์โทรศัพท์สำหรับทดสอบ</label>
                    <div class="relative">
                        <span class="absolute left-4 top-3.5 text-gray-400">
                            <i data-lucide="phone" class="w-5 h-5"></i>
                        </span>
                        <input 
                            type="tel" 
                            id="phoneInput" 
                            maxlength="10"
                            oninput="this.value = this.value.replace(/[^0-9]/g, '')"
                            placeholder="08xxxxxxxx" 
                            class="w-full pl-12 pr-4 py-3.5 bg-gray-50 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all text-lg"
                        >
                    </div>
                    <p class="text-[11px] text-gray-400 mt-2">* ใส่ได้เฉพาะตัวเลข 10 หลักเท่านั้น</p>
                </div>

                <button 
                <button 
                    id="sendBtn" 
                    onclick="handleSend()"
                    class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2 group"
                >
                    <span id="btnText">ขอรหัส OTP</span>
                    <div id="btnLoader" class="hidden loading-spinner"></div>
                </button>
            </div>

            <!-- OTP Input State (Step 2) -->
            <div id="step2" class="hidden space-y-6 animate-in fade-in zoom-in duration-300">
                <!-- Mock SMS Display -->
                <div class="bg-blue-50 border-2 border-blue-200 border-dashed p-4 rounded-xl text-center relative overflow-hidden mt-4">
                    <div class="absolute top-0 right-0 bg-blue-200 text-blue-700 text-[10px] font-bold px-2 py-1 rounded-bl-lg">MOCK SMS</div>
                    <p class="text-sm text-blue-800 font-medium mb-1 mt-2">รหัส OTP ของคุณคือ</p>
                    <p id="mockSmsText" class="text-3xl font-mono font-bold text-blue-600 tracking-widest">------</p>
                </div>

                <div>
                    <label for="otpInput" class="block text-sm font-semibold text-gray-700 mb-2">กรอกรหัสยืนยัน 6 หลัก</label>
                    <input 
                        type="text" 
                        id="otpInput" 
                        maxlength="6"
                        oninput="this.value = this.value.replace(/[^0-9]/g, '')"
                        placeholder="------" 
                        class="w-full text-center tracking-[0.5em] py-3.5 bg-gray-50 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all text-2xl font-mono"
                    >
                </div>

                <button 
                    id="verifyBtn" 
                    onclick="handleVerify()"
                    class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-green-200 transition-all flex items-center justify-center gap-2"
                >
                    ยืนยัน OTP
                </button>
                <button onclick="resetLab()" class="w-full text-sm text-gray-500 hover:text-gray-700 font-medium mt-2">ยกเลิกและเริ่มใหม่</button>
            </div>

            <!-- Success State (Step 3) -->
            <div id="step3" class="hidden text-center py-10 space-y-4 animate-in fade-in zoom-in duration-300">
                <div class="inline-flex p-4 bg-green-100 text-green-600 rounded-full">
                    <i data-lucide="check-circle-2" class="w-12 h-12"></i>
                </div>
                <h2 class="text-xl font-bold text-gray-800">ยืนยันตัวตนสำเร็จ!</h2>
                <p class="text-gray-500">เบอร์ <span id="displayPhone" class="font-semibold text-indigo-600"></span> ได้รับการยืนยันแล้ว</p>
                <button onclick="resetLab()" class="text-sm text-indigo-600 hover:underline font-medium">ทดสอบใหม่อีกครั้ง</button>
            </div>
        </div>

        <!-- Automation Metadata (For help) -->
        <div class="bg-gray-50 p-4 border-t border-gray-100">
            <p class="text-[10px] font-mono text-gray-400 uppercase tracking-widest mb-2">Automation Selectors</p>
            <div class="grid grid-cols-2 gap-2 text-[11px] font-mono">
                <div class="bg-white p-2 rounded border">Input Phone: <span class="text-red-500">#phoneInput</span></div>
                <div class="bg-white p-2 rounded border">Btn Send: <span class="text-red-500">#sendBtn</span></div>
                <div class="bg-white p-2 rounded border">Input OTP: <span class="text-red-500">#otpInput</span></div>
                <div class="bg-white p-2 rounded border">Btn Verify: <span class="text-red-500">#verifyBtn</span></div>
            </div>
        </div>
    </div>

    <!-- Alert Toast -->
    <div id="toast" class="fixed bottom-5 right-5 bg-red-500 text-white px-6 py-3 rounded-xl shadow-2xl transform translate-y-20 transition-transform duration-300 flex items-center gap-2">
        <i data-lucide="alert-circle" class="w-5 h-5"></i>
        <span id="toastMsg">กรุณากรอกเบอร์โทรศัพท์</span>
    </div>

    <script>
        lucide.createIcons();

        let currentOTP = ""; // เก็บ OTP ที่ระบบสร้างขึ้น

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMsg').innerText = msg;
            toast.style.transform = 'translateY(0)';
            setTimeout(() => { toast.style.transform = 'translateY(100px)'; }, 3000);
        }

        function handleSend() {
            const phone = document.getElementById('phoneInput').value;
            const btn = document.getElementById('sendBtn');
            const btnText = document.getElementById('btnText');
            const btnLoader = document.getElementById('btnLoader');

            // บังคับว่าต้องมี 10 หลัก
            if (phone.length !== 10) {
                showToast("กรุณากรอกเบอร์โทรศัพท์ให้ครบ 10 หลัก");
                return;
            }

            // Simulate Loading
            btn.disabled = true;
            btnText.innerText = "กำลังประมวลผล...";
            btnLoader.classList.remove('hidden');

            setTimeout(() => {
                // สุ่มรหัส 6 หลัก
                currentOTP = Math.floor(100000 + Math.random() * 900000).toString();
                
                // แสดงรหัสผ่านหน้า UI (จำลองการได้รับ SMS)
                document.getElementById('mockSmsText').innerText = currentOTP;

                // เปลี่ยน UI เป็นหน้ากรอก OTP (Step 2)
                document.getElementById('step1').classList.add('hidden');
                document.getElementById('step2').classList.remove('hidden');
                
                // รีเซ็ตปุ่มส่ง
                btn.disabled = false;
                btnText.innerText = "ขอรหัส OTP";
                btnLoader.classList.add('hidden');
            }, 2000); 
        }

        function handleVerify() {
            const inputOTP = document.getElementById('otpInput').value;
            const phone = document.getElementById('phoneInput').value;

            if (inputOTP.length !== 6) {
                showToast("กรุณากรอกรหัส OTP ให้ครบ 6 หลัก");
                return;
            }

            if (inputOTP === currentOTP) {
                // รหัสถูก เลื่อนไปหน้า Success (Step 3)
                document.getElementById('step2').classList.add('hidden');
                document.getElementById('step3').classList.remove('hidden');
                document.getElementById('displayPhone').innerText = phone;
            } else {
                // รหัสผิด
                showToast("รหัส OTP ไม่ถูกต้อง");
            }
        }

        function resetLab() {
            currentOTP = "";
            document.getElementById('step1').classList.remove('hidden');
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step3').classList.add('hidden');
            document.getElementById('phoneInput').value = '';
            document.getElementById('otpInput').value = '';
            document.getElementById('mockSmsText').innerText = '------';
        }
    </script>
</body>
</html>
